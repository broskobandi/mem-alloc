\doxysection{mem\+\_\+alloc\+\_\+utils.\+h}
\hypertarget{mem__alloc__utils_8h_source}{}\label{mem__alloc__utils_8h_source}\index{src/mem\_alloc\_utils.h@{src/mem\_alloc\_utils.h}}
\mbox{\hyperlink{mem__alloc__utils_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{/*}}
\DoxyCodeLine{00002\ \textcolor{comment}{MIT\ License}}
\DoxyCodeLine{00003\ \textcolor{comment}{}}
\DoxyCodeLine{00004\ \textcolor{comment}{Copyright\ (c)\ 2025\ broskobandi}}
\DoxyCodeLine{00005\ \textcolor{comment}{}}
\DoxyCodeLine{00006\ \textcolor{comment}{Permission\ is\ hereby\ granted,\ free\ of\ charge,\ to\ any\ person\ obtaining\ a\ copy}}
\DoxyCodeLine{00007\ \textcolor{comment}{of\ this\ software\ and\ associated\ documentation\ files\ (the\ "{}Software"{}),\ to\ deal}}
\DoxyCodeLine{00008\ \textcolor{comment}{in\ the\ Software\ without\ restriction,\ including\ without\ limitation\ the\ rights}}
\DoxyCodeLine{00009\ \textcolor{comment}{to\ use,\ copy,\ modify,\ merge,\ publish,\ distribute,\ sublicense,\ and/or\ sell}}
\DoxyCodeLine{00010\ \textcolor{comment}{copies\ of\ the\ Software,\ and\ to\ permit\ persons\ to\ whom\ the\ Software\ is}}
\DoxyCodeLine{00011\ \textcolor{comment}{furnished\ to\ do\ so,\ subject\ to\ the\ following\ conditions:}}
\DoxyCodeLine{00012\ \textcolor{comment}{}}
\DoxyCodeLine{00013\ \textcolor{comment}{The\ above\ copyright\ notice\ and\ this\ permission\ notice\ shall\ be\ included\ in\ all}}
\DoxyCodeLine{00014\ \textcolor{comment}{copies\ or\ substantial\ portions\ of\ the\ Software.}}
\DoxyCodeLine{00015\ \textcolor{comment}{}}
\DoxyCodeLine{00016\ \textcolor{comment}{THE\ SOFTWARE\ IS\ PROVIDED\ "{}AS\ IS"{},\ WITHOUT\ WARRANTY\ OF\ ANY\ KIND,\ EXPRESS\ OR}}
\DoxyCodeLine{00017\ \textcolor{comment}{IMPLIED,\ INCLUDING\ BUT\ NOT\ LIMITED\ TO\ THE\ WARRANTIES\ OF\ MERCHANTABILITY,}}
\DoxyCodeLine{00018\ \textcolor{comment}{FITNESS\ FOR\ A\ PARTICULAR\ PURPOSE\ AND\ NONINFRINGEMENT.\ IN\ NO\ EVENT\ SHALL\ THE}}
\DoxyCodeLine{00019\ \textcolor{comment}{AUTHORS\ OR\ COPYRIGHT\ HOLDERS\ BE\ LIABLE\ FOR\ ANY\ CLAIM,\ DAMAGES\ OR\ OTHER}}
\DoxyCodeLine{00020\ \textcolor{comment}{LIABILITY,\ WHETHER\ IN\ AN\ ACTION\ OF\ CONTRACT,\ TORT\ OR\ OTHERWISE,\ ARISING\ FROM,}}
\DoxyCodeLine{00021\ \textcolor{comment}{OUT\ OF\ OR\ IN\ CONNECTION\ WITH\ THE\ SOFTWARE\ OR\ THE\ USE\ OR\ OTHER\ DEALINGS\ IN\ THE}}
\DoxyCodeLine{00022\ \textcolor{comment}{SOFTWARE.}}
\DoxyCodeLine{00023\ \textcolor{comment}{\ */}}
\DoxyCodeLine{00024\ }
\DoxyCodeLine{00030\ \textcolor{preprocessor}{\#ifndef\ MEM\_ALLOC\_UTILS\_H}}
\DoxyCodeLine{00031\ \textcolor{preprocessor}{\#define\ MEM\_ALLOC\_UTILS\_H}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mem__alloc_8h}{mem\_alloc.h}}"{}}}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#include\ <stdalign.h>}\ \textcolor{comment}{/*\ for\ alignof(max\_align\_t)\ */}}
\DoxyCodeLine{00036\ \textcolor{preprocessor}{\#include\ <stdbool.h>}}
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ <sys/mman.h>}\ \textcolor{comment}{/*\ for\ mmap()\ and\ munmap()\ */}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ <string.h>}\ \textcolor{comment}{/*\ for\ memcpy()\ */}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ <unistd.h>}\ \textcolor{comment}{/*\ for\ getpagesize()\ */}}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00042\ \textcolor{comment}{\ *\ Macro\ definitions}}
\DoxyCodeLine{00043\ \textcolor{comment}{\ ****************************************************************************/}}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00047\ \textcolor{preprocessor}{\#define\ MIN\_ALLOC\_SIZE\ alignof(max\_align\_t)}}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00050\ \textcolor{preprocessor}{\#define\ ROUNDUP(size,\ to)\(\backslash\)}}
\DoxyCodeLine{00051\ \textcolor{preprocessor}{\ \ \ \ (((size)\ +\ (to)\ -\/\ 1)\ \&\ \string~((to)\ -\/\ 1))}}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00054\ \textcolor{preprocessor}{\#define\ MEM\_OFFSET\ ROUNDUP(sizeof(ptr\_t),\ MIN\_ALLOC\_SIZE)}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00057\ \textcolor{preprocessor}{\#define\ PTR\_META(mem)\ (ptr\_t*)((unsigned\ char*)(mem)\ -\/\ \ MEM\_OFFSET)}}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00062\ \textcolor{preprocessor}{\#ifndef\ ARENA\_SIZE\_CUSTOM}}
\DoxyCodeLine{00063\ \textcolor{preprocessor}{\#define\ ARENA\_SIZE\ 1024LU\ *\ 128}}
\DoxyCodeLine{00064\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00065\ \textcolor{preprocessor}{\#define\ ARENA\_SIZE\ ARENA\_SIZE\_CUSTOM}}
\DoxyCodeLine{00066\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00070\ \textcolor{preprocessor}{\#ifndef\ MAX\_NUM\_FREE\_MMAP\_PTRS\_CUSTOM}}
\DoxyCodeLine{00071\ \textcolor{preprocessor}{\#define\ MAX\_NUM\_FREE\_MMAP\_PTRS\ 8}}
\DoxyCodeLine{00072\ \textcolor{preprocessor}{\#else}}
\DoxyCodeLine{00073\ \textcolor{preprocessor}{\#define\ MAX\_NUM\_FREE\_MMAP\_PTRS\ MAX\_NUM\_FREE\_MMAP\_PTRS\_CUSTOM}}
\DoxyCodeLine{00074\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00077\ \textcolor{preprocessor}{\#define\ NUM\_SIZE\_CLASSES\ (ARENA\_SIZE\ -\/\ MEM\_OFFSET)\ /\ MIN\_ALLOC\_SIZE}}
\DoxyCodeLine{00078\ }
\DoxyCodeLine{00080\ \textcolor{preprocessor}{\#define\ SIZE\_CLASS(total\_size)\ (total\_size)\ /\ (MEM\_OFFSET\ +\ MIN\_ALLOC\_SIZE)}}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00083\ \textcolor{preprocessor}{\#define\ MMAP(total\_size)\(\backslash\)}}
\DoxyCodeLine{00084\ \textcolor{preprocessor}{\ \ \ \ mmap(\(\backslash\)}}
\DoxyCodeLine{00085\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ NULL,\(\backslash\)}}
\DoxyCodeLine{00086\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ (total\_size),\(\backslash\)}}
\DoxyCodeLine{00087\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ PROT\_WRITE\ |\ PROT\_READ,\(\backslash\)}}
\DoxyCodeLine{00088\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ MAP\_PRIVATE\ |\ MAP\_ANONYMOUS,\(\backslash\)}}
\DoxyCodeLine{00089\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ -\/1,\(\backslash\)}}
\DoxyCodeLine{00090\ \textcolor{preprocessor}{\ \ \ \ \ \ \ \ 0\(\backslash\)}}
\DoxyCodeLine{00091\ \textcolor{preprocessor}{\ \ \ \ );}}
\DoxyCodeLine{00092\ }
\DoxyCodeLine{00093\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00094\ \textcolor{comment}{\ *\ Structs}}
\DoxyCodeLine{00095\ \textcolor{comment}{\ ****************************************************************************/}}
\DoxyCodeLine{00096\ }
\DoxyCodeLine{00098\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structptr}{ptr}}\ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00101\ \textcolor{keyword}{typedef}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structarena}{arena}}\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}};}
\DoxyCodeLine{00102\ }
\DoxyCodeLine{00104\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structptr}{ptr}}\ \{}
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00110\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}};}
\DoxyCodeLine{00111\ }
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}};}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}};}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}};}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}};}
\DoxyCodeLine{00126\ }
\DoxyCodeLine{00129\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}};}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00133\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{structptr_aaeb7f5397d80ea61be9b15d4af4bc8e9}{is\_mmap}};}
\DoxyCodeLine{00134\ \};}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00137\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structarena}{arena}}\ \{}
\DoxyCodeLine{00139\ \ \ \ \ \textcolor{keyword}{alignas}(max\_align\_t)\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \mbox{\hyperlink{structarena_ab4e293262339e85da16031d075756d2e}{buff}}[\mbox{\hyperlink{mem__alloc__utils_8h_a716f9c94eab29ae62af2ce55bf23db20}{ARENA\_SIZE}}];}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00142\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structarena_afb9c6f177b30b12ef1fd8a9f2aa5430b}{free\_ptr\_tails}}[\mbox{\hyperlink{mem__alloc__utils_8h_aebe827a717f3560e566b903cb50d45b6}{NUM\_SIZE\_CLASSES}}];}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00145\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structarena_aa3cdd67716bd1f063f302a2fe410d756}{ptrs\_tail}};}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}};}
\DoxyCodeLine{00151\ \};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00154\ \textcolor{comment}{\ *\ Helpers\ for\ the\ test\ utility}}
\DoxyCodeLine{00155\ \textcolor{comment}{\ ****************************************************************************/}}
\DoxyCodeLine{00156\ }
\DoxyCodeLine{00157\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{mem__alloc__utils_8h_a78041a67cfa879c68471be5411386d0d}{global\_arena}}();}
\DoxyCodeLine{00158\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mem__alloc__utils_8h_a5810db035e2b43da6184f9df1b89c064}{reset\_arena}}();}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \textcolor{comment}{/*****************************************************************************}}
\DoxyCodeLine{00161\ \textcolor{comment}{\ *\ Helpers\ for\ the\ public\ functions}}
\DoxyCodeLine{00162\ \textcolor{comment}{\ ****************************************************************************/}}
\DoxyCodeLine{00163\ }
\DoxyCodeLine{00164\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{mem__alloc__utils_8h_ab7af48d6cccffa1d1d176f62cff97841}{use\_free\_list}}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ **free\_tail)\ \{}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{comment}{/*\ Init\ ptr\ */}}
\DoxyCodeLine{00166\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}}\ =\ *free\_tail;}
\DoxyCodeLine{00167\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{comment}{/*\ Update\ free\ list.\ */}}
\DoxyCodeLine{00170\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*free\_tail)-\/>prev\_free)\ \{}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ *free\_tail\ =\ (*free\_tail)-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}};}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ (*free\_tail)-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ NULL;}
\DoxyCodeLine{00173\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ *free\_tail\ =\ NULL;}
\DoxyCodeLine{00175\ \ \ \ \ \}}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ NULL;}
\DoxyCodeLine{00178\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ NULL;}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00180\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00181\ \}}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{mem__alloc__utils_8h_a7d0f74ddef3135cf0bd485bd30d9a387}{use\_arena}}(\textcolor{keywordtype}{size\_t}\ total\_size,\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{structarena}{arena}})\ \{}
\DoxyCodeLine{00184\ \ \ \ \ \textcolor{comment}{/*\ Init\ ptr\ */}}
\DoxyCodeLine{00185\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}}\ =\ (\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}*)\&\mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ab4e293262339e85da16031d075756d2e}{buff}}[\mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}}];}
\DoxyCodeLine{00186\ \ \ \ \ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}}\ +=\ total\_size;}
\DoxyCodeLine{00187\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ NULL;}
\DoxyCodeLine{00188\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ NULL;}
\DoxyCodeLine{00189\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ NULL;}
\DoxyCodeLine{00190\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00191\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aaeb7f5397d80ea61be9b15d4af4bc8e9}{is\_mmap}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00192\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ =\ total\_size;}
\DoxyCodeLine{00193\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}}\ =\ (\textcolor{keywordtype}{void}*)((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\mbox{\hyperlink{structptr}{ptr}}\ +\ \mbox{\hyperlink{mem__alloc__utils_8h_ab876507b6bfd5d4f9d24320bb1f336d1}{MEM\_OFFSET}});}
\DoxyCodeLine{00194\ }
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{comment}{/*\ Update\ ptr\ list.\ */}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_aa3cdd67716bd1f063f302a2fe410d756}{ptrs\_tail}})\ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_aa3cdd67716bd1f063f302a2fe410d756}{ptrs\_tail}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ \mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}\ =\ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_aa3cdd67716bd1f063f302a2fe410d756}{ptrs\_tail}};}
\DoxyCodeLine{00199\ \ \ \ \ \}}
\DoxyCodeLine{00200\ \ \ \ \ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_aa3cdd67716bd1f063f302a2fe410d756}{ptrs\_tail}}\ =\ \mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00201\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00202\ \}}
\DoxyCodeLine{00203\ }
\DoxyCodeLine{00204\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{mem__alloc__utils_8h_af500fa49897288e8a9c5515174c3de46}{use\_mmap}}(\textcolor{keywordtype}{size\_t}\ total\_size)\ \{}
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{comment}{/*\ Init\ ptr\ */}}
\DoxyCodeLine{00206\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ updated\_total\_size\ =\ \mbox{\hyperlink{mem__alloc__utils_8h_a61dd3ed223b771e293392fb7ff7bf910}{ROUNDUP}}(total\_size,\ (\textcolor{keywordtype}{size\_t})getpagesize());}
\DoxyCodeLine{00207\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}}\ =\ (\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}*)\mbox{\hyperlink{mem__alloc__utils_8h_a8b8dd6cbcc42cd3de8514a8077e31ccb}{MMAP}}(updated\_total\_size);}
\DoxyCodeLine{00208\ \ \ \ \ \textcolor{keywordflow}{if}\ (!\mbox{\hyperlink{structptr}{ptr}})\ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{00209\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}\ =\ NULL;}
\DoxyCodeLine{00210\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ NULL;}
\DoxyCodeLine{00211\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ NULL;}
\DoxyCodeLine{00212\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ NULL;}
\DoxyCodeLine{00213\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00214\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aaeb7f5397d80ea61be9b15d4af4bc8e9}{is\_mmap}}\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00215\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ =\ updated\_total\_size;}
\DoxyCodeLine{00216\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}}\ =\ (\textcolor{keywordtype}{void}*)((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)\mbox{\hyperlink{structptr}{ptr}}\ +\ \mbox{\hyperlink{mem__alloc__utils_8h_ab876507b6bfd5d4f9d24320bb1f336d1}{MEM\_OFFSET}});}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00218\ \}}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mem__alloc__utils_8h_a1b2b3697a33b91e7d8ce67e31903ff98}{add\_to\_free\_list}}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{structarena}{arena}})\ \{}
\DoxyCodeLine{00221\ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00222\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ **tail\ =\ \&\mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_afb9c6f177b30b12ef1fd8a9f2aa5430b}{free\_ptr\_tails}}[\mbox{\hyperlink{mem__alloc__utils_8h_a26cc0bfded51d250cd33b75dc44e603d}{SIZE\_CLASS}}(\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}})];}
\DoxyCodeLine{00223\ \ \ \ \ \textcolor{keywordflow}{if}\ (*tail)\ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ (*tail)-\/>next\_free\ =\ \mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ (*tail);}
\DoxyCodeLine{00226\ \ \ \ \ \}}
\DoxyCodeLine{00227\ \ \ \ \ *tail\ =\ \mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00228\ \}}
\DoxyCodeLine{00229\ }
\DoxyCodeLine{00230\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{structarena}{arena}})\ \{}
\DoxyCodeLine{00231\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ **tail\ =\ \&\mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_afb9c6f177b30b12ef1fd8a9f2aa5430b}{free\_ptr\_tails}}[\mbox{\hyperlink{mem__alloc__utils_8h_a26cc0bfded51d250cd33b75dc44e603d}{SIZE\_CLASS}}(\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}})];}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}})\ \{}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}};}
\DoxyCodeLine{00234\ \ \ \ \ \}\ \textcolor{keywordflow}{else}\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ *tail\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}};}
\DoxyCodeLine{00236\ \ \ \ \ \}}
\DoxyCodeLine{00237\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}})}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}};}
\DoxyCodeLine{00239\ \}}
\DoxyCodeLine{00240\ }
\DoxyCodeLine{00241\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mem__alloc__utils_8h_aa28d1bd2c68bea9d10765c8133ae887b}{merge\_neighbouring\_ptrs}}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{structarena}{arena}})\ \{}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ \&\&\ !\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}})\ \{}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ +=\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}\ =\ \mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a1b2b3697a33b91e7d8ce67e31903ff98}{add\_to\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00249\ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}\ \&\&\ !\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}})\ \{}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ +=\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}};}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}};}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}})}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}\ =\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}};}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a1b2b3697a33b91e7d8ce67e31903ff98}{add\_to\_free\_list}}(\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}},\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00258\ \ \ \ \ \}}
\DoxyCodeLine{00259\ \}}
\DoxyCodeLine{00260\ }
\DoxyCodeLine{00261\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{mem__alloc__utils_8h_ab705b26c82012fd743f6a2e87786c28d}{move\_ptr}}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ **\mbox{\hyperlink{structptr}{ptr}},\ \textcolor{keywordtype}{size\_t}\ size)\ \{}
\DoxyCodeLine{00262\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *new\_ptr\ =\ (\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}*)((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)*\mbox{\hyperlink{structptr}{ptr}}\ +\ size);}
\DoxyCodeLine{00263\ \ \ \ \ memcpy(new\_ptr,\ *\mbox{\hyperlink{structptr}{ptr}},\ \textcolor{keyword}{sizeof}(\mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}));}
\DoxyCodeLine{00264\ \ \ \ \ *\mbox{\hyperlink{structptr}{ptr}}\ =\ new\_ptr;}
\DoxyCodeLine{00265\ \ \ \ \ (*ptr)-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}}\ =\ ((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}*)*\mbox{\hyperlink{structptr}{ptr}}\ +\ \mbox{\hyperlink{mem__alloc__utils_8h_ab876507b6bfd5d4f9d24320bb1f336d1}{MEM\_OFFSET}});}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ptr)-\/>next\_in\_arena)}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ (*ptr)-\/>next\_in\_arena-\/>prev\_in\_arena\ =\ *\mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00268\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ptr)-\/>prev\_in\_arena)}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ (*ptr)-\/>\mbox{\hyperlink{structptr_a0827a01b08507a6e2cce7756e219d710}{prev\_in\_arena}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}}\ =\ *\mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00270\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ptr)-\/>next\_free)}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ (*ptr)-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}\ =\ *\mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00272\ \ \ \ \ \textcolor{keywordflow}{if}\ ((*ptr)-\/>prev\_free)}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ (*ptr)-\/>\mbox{\hyperlink{structptr_a65ff98b157d08c780e7f0ca264fcf59d}{prev\_free}}-\/>\mbox{\hyperlink{structptr_a2a3239a38c5bee699187efce41b53d07}{next\_free}}\ =\ *\mbox{\hyperlink{structptr}{ptr}};}
\DoxyCodeLine{00274\ \}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ \textcolor{keyword}{static}\ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ *\mbox{\hyperlink{mem__alloc__utils_8h_a3df2794c6fe1084f02236a7b24a104f6}{realloc\_in\_place}}(}
\DoxyCodeLine{00277\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ *\mbox{\hyperlink{structptr}{ptr}},\ \textcolor{keywordtype}{size\_t}\ total\_size,\ \mbox{\hyperlink{mem__alloc__utils_8h_a6511b561eba6017d3f09e9ef44b6b500}{arena\_t}}\ *\mbox{\hyperlink{structarena}{arena}}}
\DoxyCodeLine{00278\ )\ \{}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{comment}{/*\ If\ current\ size\ is\ enough\ */}}
\DoxyCodeLine{00280\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ >=\ total\_size)}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00282\ }
\DoxyCodeLine{00283\ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a6b9b826ca50c2f0495c9ce0b70b6c172}{ptr\_t}}\ **next\ =\ \&\mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a71605f5eea7aea5e808fa1d63ab83ee2}{next\_in\_arena}};}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordtype}{size\_t}\ extra\_size\_needed\ =}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a61dd3ed223b771e293392fb7ff7bf910}{ROUNDUP}}(total\_size\ -\/\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}},\ \mbox{\hyperlink{mem__alloc__utils_8h_adc61bfb7f4679bc2eae735449c406ba8}{MIN\_ALLOC\_SIZE}});}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \textcolor{comment}{/*\ If\ next\ pointer\ is\ free\ and\ is\ bigger\ than\ needed\ */}}
\DoxyCodeLine{00288\ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ *next\ \&\&\ !(*next)-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ \&\&}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ (*next)-\/>total\_size\ >=}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ extra\_size\_needed\ +\ \mbox{\hyperlink{mem__alloc__utils_8h_ab876507b6bfd5d4f9d24320bb1f336d1}{MEM\_OFFSET}}\ +\ \mbox{\hyperlink{mem__alloc__utils_8h_adc61bfb7f4679bc2eae735449c406ba8}{MIN\_ALLOC\_SIZE}}}
\DoxyCodeLine{00292\ \ \ \ \ )\ \{}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_ab705b26c82012fd743f6a2e87786c28d}{move\_ptr}}(next,\ extra\_size\_needed);}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ (*next)-\/>total\_size\ -\/=\ extra\_size\_needed;}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(*next,\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_a1b2b3697a33b91e7d8ce67e31903ff98}{add\_to\_free\_list}}(*next,\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ +=\ extra\_size\_needed;}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00299\ \ \ \ \ \}}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{comment}{/*\ If\ next\ pointer\ is\ free\ and\ is\ just\ as\ big\ as\ needed\ */}}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ *next\ \&\&\ !(*next)-\/>\mbox{\hyperlink{structptr_a84eb3588d91fdf99d559d08dee49e898}{is\_valid}}\ \&\&}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ (*next)-\/>total\_size\ ==\ extra\_size\_needed}
\DoxyCodeLine{00305\ \ \ \ \ )\ \{}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{mem__alloc__utils_8h_adb8ca0934997cc504c7faf4f1e0f2eb6}{remove\_from\_free\_list}}(*next,\ \mbox{\hyperlink{structarena}{arena}});}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ +=\ extra\_size\_needed;}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}}\ +=\ extra\_size\_needed;}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00310\ \ \ \ \ \}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \textcolor{comment}{/*\ If\ there\ is\ no\ next\ pointer.\ */}}
\DoxyCodeLine{00313\ \ \ \ \ \textcolor{keywordflow}{if}\ (!*next\ \&\&\ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}}\ +\ extra\_size\_needed\ <=\ \mbox{\hyperlink{mem__alloc__utils_8h_a716f9c94eab29ae62af2ce55bf23db20}{ARENA\_SIZE}})\ \{}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_aad91356fc26a29cfaa6ca3a66969daaa}{total\_size}}\ +=\ extra\_size\_needed;}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structarena}{arena}}-\/>\mbox{\hyperlink{structarena_ad43647b9a57d022f3bbaabaa38371904}{offset}}\ +=\ extra\_size\_needed;}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{structptr}{ptr}}-\/>\mbox{\hyperlink{structptr_a3c17a67bbb6910f7eac4f35b20189a59}{mem}};}
\DoxyCodeLine{00317\ \ \ \ \ \}}
\DoxyCodeLine{00318\ }
\DoxyCodeLine{00319\ \ \ \ \ \textcolor{keywordflow}{return}\ NULL;}
\DoxyCodeLine{00320\ \}}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
